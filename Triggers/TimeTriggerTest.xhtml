<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
    <link rel='stylesheet' type='text/css' href='http://www.x3dom.org/x3dom/release/x3dom.css'/>
    <script type='text/javascript' src='http://www.x3dom.org/x3dom/release/x3dom.js'/> 
    <script src="./X3DTriggerNode.js" type="text/javascript" charset="utf-8"></script> 
    <script src="./TimeTrigger.js" type="text/javascript" charset="utf-8"></script> 
    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script> 
    <script src="./start.js" type="text/javascript" charset="utf-8"></script> 

  </head>
  <body>
    <X3D xmlns='http://www.web3d.org/specifications/x3d-namespace' id='someUniqueId' showStat='false' showLog='false' x='0px' y='0px' width='400px' height='400px'>
      <Scene>
        <ExternProtoDeclare name='WhereAmI' url='"http://X3dGraphics.com/examples/X3dForWebAuthors/Chapter14-Prototypes/WhereAmIPrototype.x3d#WhereAmI"'/>
        <WorldInfo info='"DTG of last update: 081200Jun98 Added: Updated: cycleInterval to 5.5 Modeled by: Todd Gagnon and Mark A. Boyd"' title='pumpHouse1.4.wrl'/>
        <WhereAmI/>
        <Background skyColor='1 1 1'/>
        <Viewpoint description='Book View' orientation='-0.969 0.239 0.056 0.13' position='1.66 1.34 5.95'/>
        <Group>
          <Transform scale='0.91 0.6 0.3' translation='0.8 -0.65 0.5'>
            <Shape>
              <Appearance>
                <Material diffuseColor='0.749 0.694 0.651'/>
              </Appearance>
              <Cylinder bottom='false' top='false'/>
            </Shape>
          </Transform>
          <Group>
            <Shape onclick="start();">
              <Appearance DEF='PumpHouseAppearance'>
                <Material diffuseColor='0.82 0.78 0.74'/>
              </Appearance>
              <IndexedFaceSet coordIndex='0 1 5 4 -1 5 1 2 6 -1 6 2 3 7 -1 3 0 4 7 -1 1 12 13 2 -1 2 13 14 -1 12 15 16 13 -1 15 0 3 16 -1 16 3 17 -1 9 5 6 10 -1 8 9 10 11 -1 4 8 11 7 -1 4 5 9 8 -1 11 10 6 7 -1 3 2 14 17 -1 13 16 17 14 -1'>
                <Coordinate point='0 0 0 2 0 0 2 1.75 0 0 1.75 0 0.625 0.75 0 1 0.75 0 1 1.6 0 0.625 1.6 0 0.625 0.75 -0.65 1 0.75 -0.65 1 1.6 -0.65 0.625 1.6 -0.65 2 0 -2.7 2 1.75 -2.7 2 2.5 -1 0 0 -2.7 0 1.75 -2.7 0 2.5 -1'/>
              </IndexedFaceSet>
            </Shape>
            <TouchSensor DEF='PumpTouched' description='touch to activate'/>
          </Group>
        </Group>
        <Group>
          <Transform scale='0.5 0.5 0.5' translation='1 1.1 -1.5'>
            <Transform DEF='PistonTransform'>
              <Transform scale='1.8 1.2 0.6' translation='0 -0.2 0'>
                <Shape>
                  <Appearance>
                    <Material diffuseColor='0.427 0.427 0.42'/>
                  </Appearance>
                  <Cylinder height='1' radius='0.98'/>
                </Shape>
              </Transform>
              <Transform DEF='CylinderRod' rotation='0 0 -1 0.523599' translation='-0.25 0.75 0'>
                <Shape>
                  <Appearance USE='PumpHouseAppearance'/>
                  <Cylinder height='1' radius='0.1'/>
                </Shape>
              </Transform>
              <Transform rotation='0 0 1 1.0472' translation='1 0.6 0'>
                <Transform USE='CylinderRod'/>
              </Transform>
              <Transform translation='0 1.2 0'>
                <Shape>
                  <Appearance USE='PumpHouseAppearance'/>
                  <Sphere radius='0.15'/>
                </Shape>
              </Transform>
              <Transform DEF='RockerArm1' center='0 -0.4 0'>
                <Shape>
                  <Appearance USE='PumpHouseAppearance'/>
                  <Cylinder height='1.8' radius='0.1'/>
                </Shape>
                <Transform translation='0 0.95 0'>
                  <Shape>
                    <Appearance USE='PumpHouseAppearance'/>
                    <Sphere radius='0.15'/>
                  </Shape>
                </Transform>
                <PositionInterpolator DEF='Rocker1Path' key='0 0.3 0.32 0.5 0.75 1' keyValue='0 2 -0.25 0 1.8 -0.35 0 1.8 -0.35 0 2 -0.25 0 2 -0.12 0 2 -0.25'/>
                <OrientationInterpolator DEF='Rocker1Rotation' key='0 0.3 0.32 0.5 0.75 1' keyValue='-1 0 0 0.523599 -1 0 0 1.0472 -1 0 0 1.0472 -1 0 0 0.523599 -1 0 0 0.261799 -1 0 0 0.523599'/>
              </Transform>
              <Transform DEF='RockerArm2' center='0 0.7 0'>
                <Shape>
                  <Appearance USE='PumpHouseAppearance'/>
                  <Cylinder height='1.8' radius='0.1'/>
                </Shape>
                <Transform translation='0 -0.95 0'>
                  <Shape>
                    <Appearance USE='PumpHouseAppearance'/>
                    <Sphere radius='0.15'/>
                  </Shape>
                </Transform>
                <PositionInterpolator DEF='Rocker2Path' key='0 0.3 0.32 0.5 0.75 1' keyValue='0 1.95 -1 0 1.2 -1.6 0 1.2 -1.6 0 1.95 -1 0 2.2 -0.65 0 1.95 -1'/>
                <OrientationInterpolator DEF='Rocker2Rotation' key='0 0.3 0.32 0.5 0.75 1' keyValue='1 0 0 0.523599 1 0 0 0.4 1 0 0 0.4 1 0 0 0.523599 1 0 0 1.5708 1 0 0 0.523599'/>
              </Transform>
            </Transform>
            <TimeSensor DEF='PistonClock' cycleInterval='5.5'/>
            <PositionInterpolator DEF='PistonPath' key='0 0.3 0.32 0.5 0.75 1' keyValue='-0.4 -2.3 4 -0.4 -1.5 4 -0.4 -1.5 4 -0.4 -2.3 4 -0.4 -3.3 4 -0.4 -2.3 4'/>
            <TimeTrigger DEF='Filter'/>
            <TimeSensor id='Clock2' cycleInterval='2' enabled='false'/>
          </Transform>
        </Group>
        <ROUTE fromNode='PistonClock' fromField='fraction_changed' toNode='PistonPath' toField='set_fraction'/>
        <ROUTE fromNode='PistonClock' fromField='fraction_changed' toNode='Rocker2Path' toField='set_fraction'/>
        <ROUTE fromNode='PistonClock' fromField='fraction_changed' toNode='Rocker1Rotation' toField='set_fraction'/>
        <ROUTE fromNode='PistonClock' fromField='fraction_changed' toNode='Rocker1Path' toField='set_fraction'/>
        <ROUTE fromNode='Clock2' fromField='isActive' toNode='Filter' toField='set_boolean'/>
        <ROUTE fromNode='PistonClock' fromField='fraction_changed' toNode='Rocker2Rotation' toField='set_fraction'/>
        <ROUTE fromNode='Filter' fromField='triggerTime' toNode='PistonClock' toField='set_startTime'/>
        <ROUTE fromNode='PistonPath' fromField='value_changed' toNode='PistonTransform' toField='set_translation'/>
        <ROUTE fromNode='Rocker1Path' fromField='value_changed' toNode='RockerArm1' toField='set_translation'/>
        <ROUTE fromNode='Rocker2Rotation' fromField='value_changed' toNode='RockerArm2' toField='set_rotation'/>
        <ROUTE fromNode='Rocker1Rotation' fromField='value_changed' toNode='RockerArm1' toField='set_rotation'/>
        <ROUTE fromNode='Rocker2Path' fromField='value_changed' toNode='RockerArm2' toField='set_translation'/>
      </Scene>
    </X3D>
  </body>
</html>
